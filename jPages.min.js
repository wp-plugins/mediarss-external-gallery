/** jQuery jPages v0.6
 * Client side pagination with jQuery
 * http://luis-almeida.github.com/jPages
 *
 * Licensed under the MIT license.
 * Copyright 2012 Lu√≠s Almeida
 * https://github.com/luis-almeida */
(function(d,h,i,g){function c(a,b){this.options=d.extend({},j,b);this._container=d("#"+this.options.containerID);this._container.length&&(this.jQwindow=d(h),this.jQdocument=d(i),this._holder=d(a),this._nav={},this._first=d(this.options.first),this._previous=d(this.options.previous),this._next=d(this.options.next),this._last=d(this.options.last),this._items=this._container.children(":visible"),this._itemsShowing=d([]),this._itemsHiding=d([]),this._numPages=Math.ceil(this._items.length/this.options.perPage), this._currentPageNum=this.options.startPage,this._clicked=!1,this._cssAnimSupport=this.getCSSAnimationSupport(),this.init())}var f=null,j={containerID:"",first:!1,previous:"&#8592; previous",next:"next &#8594;",last:!1,links:"numeric",startPage:1,perPage:10,midRange:5,startRange:1,endRange:1,keyBrowse:!1,scrollBrowse:!1,pause:0,clickStop:!1,delay:50,direction:"forward",animation:"",fallback:400,minHeight:!0,callback:g};c.prototype.getCSSAnimationSupport=function(){var a=!1,b=["Webkit","Moz","O","ms", "Khtml"],e="",e=this._container.get(0);e.style.animationName&&(a=!0);if(!1===a)for(var c=0;c<b.length;c++)if(e.style[b[c]+"AnimationName"]!==g){e=b[c];e.toLowerCase();a=!0;break}return a};c.prototype.init=function(){this.setStyles();this.setNav();this.paginate(this._currentPageNum);this.setMinHeight()};c.prototype.setStyles=function(){d("<style>.jp-invisible { visibility: hidden !important; } .jp-hidden { display: none !important; }</style>").appendTo("head");this._cssAnimSupport&&this.options.animation.length? this._items.addClass("animated jp-hidden"):this._items.hide()};c.prototype.setNav=function(){var a=this.writeNav();this._holder.each(this.bind(function(b,e){var c=d(e);c.html(a);this.cacheNavElements(c,b);this.bindNavHandlers(b);this.disableNavSelection(e)},this));this.options.keyBrowse&&this.bindNavKeyBrowse();this.options.scrollBrowse&&this.bindNavScrollBrowse()};c.prototype.writeNav=function(){var a=1,b;for(b=this.writeBtn("first")+this.writeBtn("previous");a<=this._numPages;a++){1===a&&0===this.options.startRange&& (b+="<span>...</span>");b=a>this.options.startRange&&a<=this._numPages-this.options.endRange?b+"<a href='#' class='jp-hidden'>":b+"<a>";switch(this.options.links){case "numeric":b+=a;break;case "title":var e=this._items.eq(a-1).attr("data-title");b+=e!==g?e:""}b+="</a>";if(a===this.options.startRange||a===this._numPages-this.options.endRange)b+="<span>...</span>"}return b+=this.writeBtn("next")+this.writeBtn("last")+"</div>"};c.prototype.writeBtn=function(a){return!1!==this.options[a]&&!d(this["_"+ a]).length?"<a class='jp-"+a+"'>"+this.options[a]+"</a>":""};c.prototype.cacheNavElements=function(a,b){this._nav[b]={};this._nav[b].holder=a;this._nav[b].first=this._first.length?this._first:this._nav[b].holder.find("a.jp-first");this._nav[b].previous=this._previous.length?this._previous:this._nav[b].holder.find("a.jp-previous");this._nav[b].next=this._next.length?this._next:this._nav[b].holder.find("a.jp-next");this._nav[b].last=this._last.length?this._last:this._nav[b].holder.find("a.jp-last"); this._nav[b].fstBreak=this._nav[b].holder.find("span:first");this._nav[b].lstBreak=this._nav[b].holder.find("span:last");this._nav[b].pages=this._nav[b].holder.find("a").not(".jp-first, .jp-previous, .jp-next, .jp-last");this._nav[b].permPages=this._nav[b].pages.slice(0,this.options.startRange).add(this._nav[b].pages.slice(this._numPages-this.options.endRange,this._numPages));this._nav[b].pagesShowing=d([]);this._nav[b].currentPage=d([])};c.prototype.bindNavHandlers=function(a){var b=this._nav[a]; b.holder.bind("click.jPages",this.bind(function(a){var c=this.getNewPage(b,d(a.target));this.validNewPage(c)&&(this._clicked=!0,this.paginate(c));a.preventDefault()},this));this._first.length&&this._first.bind("click.jPages",this.bind(function(){this.validNewPage(1)&&(this._clicked=!0,this.paginate(1))},this));this._previous.length&&this._previous.bind("click.jPages",this.bind(function(){var a=this._currentPageNum-1;this.validNewPage(a)&&(this._clicked=!0,this.paginate(a))},this));this._next.length&& this._next.bind("click.jPages",this.bind(function(){var a=this._currentPageNum+1;this.validNewPage(a)&&(this._clicked=!0,this.paginate(a))},this));this._last.length&&this._last.bind("click.jPages",this.bind(function(){this.validNewPage(this._numPages)&&(this._clicked=!0,this.paginate(this._numPages))},this))};c.prototype.disableNavSelection=function(a){"undefined"!=typeof a.onselectstart?a.onselectstart=function(){return!1}:"undefined"!=typeof a.style.MozUserSelect?a.style.MozUserSelect="none":a.onmousedown= function(){return!1}};c.prototype.bindNavKeyBrowse=function(){this.jQdocument.bind("keydown.jPages",this.bind(function(a){var b=a.target.nodeName.toLowerCase();this.elemScrolledIntoView()&&("input"!==b&&"textarea"!=b)&&(b=this._currentPageNum,37==a.which&&(b=this._currentPageNum-1),39==a.which&&(b=this._currentPageNum+1),this.validNewPage(b)&&(this._clicked=!0,this.paginate(b)))},this))};c.prototype.elemScrolledIntoView=function(){var a,b,c;a=this.jQwindow.scrollTop();b=a+this.jQwindow.height();c= this._container.offset().top;return c+this._container.height()>=a&&c<=b};c.prototype.bindNavScrollBrowse=function(){this._container.bind("mousewheel.jPages DOMMouseScroll.jPages",this.bind(function(a){var b=0<(a.originalEvent.wheelDelta||-a.originalEvent.detail)?this._currentPageNum-1:this._currentPageNum+1;this.validNewPage(b)&&(this._clicked=!0,this.paginate(b));a.preventDefault();return!1},this))};c.prototype.getNewPage=function(a,b){if(b.is(a.currentPage))return this._currentPageNum;if(b.is(a.pages))return a.pages.index(b)+ 1;if(b.is(a.first))return 1;if(b.is(a.last))return this._numPages;if(b.is(a.previous))return a.pages.index(a.currentPage);if(b.is(a.next))return a.pages.index(a.currentPage)+2};c.prototype.validNewPage=function(a){return a!==this._currentPageNum&&0<a&&a<=this._numPages?!0:!1};c.prototype.paginate=function(a){var b,c;b=this.updateItems(a);c=this.updatePages(a);this._currentPageNum=a;d.isFunction(this.options.callback)&&this.callback(a,b,c);this.updatePause()};c.prototype.updateItems=function(a){var b= this.getItemRange(a);this._itemsHiding=this._itemsShowing;this._itemsShowing=this._items.slice(b.start,b.end);this._cssAnimSupport&&this.options.animation.length?this.cssAnimations(a):this.jQAnimations(a);return b};c.prototype.getItemRange=function(a){var b={};b.start=(a-1)*this.options.perPage;b.end=b.start+this.options.perPage;b.end>this._items.length&&(b.end=this._items.length);return b};c.prototype.cssAnimations=function(a){clearInterval(this._delay);this._itemsHiding.removeClass(this.options.animation+ " jp-invisible").addClass("jp-hidden");this._itemsShowing.removeClass("jp-hidden").addClass("jp-invisible");this._itemsOriented=this.getDirectedItems(a);this._index=0;this._delay=setInterval(this.bind(function(){this._index===this._itemsOriented.length?clearInterval(this._delay):this._itemsOriented.eq(this._index).removeClass("jp-invisible").addClass(this.options.animation);this._index+=1},this),this.options.delay)};c.prototype.jQAnimations=function(a){clearInterval(this._delay);this._itemsHiding.addClass("jp-hidden"); this._itemsShowing.fadeTo(0,0).removeClass("jp-hidden");this._itemsOriented=this.getDirectedItems(a);this._index=0;this._delay=setInterval(this.bind(function(){this._index===this._itemsOriented.length?clearInterval(this._delay):this._itemsOriented.eq(this._index).fadeTo(this.options.fallback,1);this._index+=1},this),this.options.delay)};c.prototype.getDirectedItems=function(a){switch(this.options.direction){case "backwards":a=d(this._itemsShowing.get().reverse());break;case "random":a=d(this._itemsShowing.get().sort(function(){return Math.round(Math.random())- 0.5}));break;case "auto":a=a>=this._currentPageNum?this._itemsShowing:d(this._itemsShowing.get().reverse());break;default:a=this._itemsShowing}return a};c.prototype.updatePages=function(a){var b,c,d;b=this.getInterval(a);for(c in this._nav)this._nav.hasOwnProperty(c)&&(d=this._nav[c],this.updateBtns(d,a),this.updateCurrentPage(d,a),this.updatePagesShowing(d,b),this.updateBreaks(d,b));return b};c.prototype.getInterval=function(a){var b,c;b=Math.ceil(this.options.midRange/2);c=this._numPages-this.options.midRange; c=a>b?Math.max(Math.min(a-b,c),0):0;a=a>b?Math.min(a+b-(0<this.options.midRange%2?1:0),this._numPages):Math.min(this.options.midRange,this._numPages);return{start:c,end:a}};c.prototype.updateBtns=function(a,b){1===b&&(a.first.addClass("jp-disabled"),a.previous.addClass("jp-disabled"));b===this._numPages&&(a.next.addClass("jp-disabled"),a.last.addClass("jp-disabled"));1===this._currentPageNum&&1<b&&(a.first.removeClass("jp-disabled"),a.previous.removeClass("jp-disabled"));this._currentPageNum===this._numPages&& b<this._numPages&&(a.next.removeClass("jp-disabled"),a.last.removeClass("jp-disabled"))};c.prototype.updateCurrentPage=function(a,b){a.currentPage.removeClass("jp-current");a.currentPage=a.pages.eq(b-1).addClass("jp-current")};c.prototype.updatePagesShowing=function(a,b){var c=a.pages.slice(b.start,b.end).not(a.permPages);a.pagesShowing.not(c).addClass("jp-hidden");c.not(a.pagesShowing).removeClass("jp-hidden");a.pagesShowing=c};c.prototype.updateBreaks=function(a,b){b.start>this.options.startRange|| 0===this.options.startRange&&0<b.start?a.fstBreak.removeClass("jp-hidden"):a.fstBreak.addClass("jp-hidden");b.end<this._numPages-this.options.endRange?a.lstBreak.removeClass("jp-hidden"):a.lstBreak.addClass("jp-hidden")};c.prototype.callback=function(a,b,c){a={current:a,interval:c,count:this._numPages};b={showing:this._itemsShowing,oncoming:this._items.slice(b.start+this.options.perPage,b.end+this.options.perPage),range:b,count:this._items.length};a.interval.start+=1;b.range.start+=1;this.options.callback(a, b)};c.prototype.updatePause=function(){if(this.options.pause&&1<this._numPages&&(clearTimeout(this._pause),!this.options.clickStop||!this._clicked))this._pause=setTimeout(this.bind(function(){this.paginate(this._currentPageNum!==this._numPages?this._currentPageNum+1:1)},this),this.options.pause)};c.prototype.setMinHeight=function(){this.options.minHeight&&!this._container.is("table, tbody")&&setTimeout(this.bind(function(){this._container.css({"min-height":this._container.css("height")})},this),1E3)}; c.prototype.bind=function(a,b){return function(){return a.apply(b,arguments)}};c.prototype.destroy=function(){this.jQdocument.unbind("keydown.jPages");this._container.unbind("mousewheel.jPages DOMMouseScroll.jPages");this.options.minHeight&&this._container.css("min-height","");this._cssAnimSupport&&this.options.animation.length?this._items.removeClass("animated jp-hidden jp-invisible "+this.options.animation):this._items.removeClass("jp-hidden").fadeTo(0,1);this._holder.unbind("click.jPages").empty()}; d.fn.jPages=function(a){var b=d.type(a);if("object"===b)return this.length&&!d.data(this,"jPages")&&(f=new c(this,a),this.each(function(){d.data(this,"jPages",f)})),this;if("string"===b&&"destroy"===a)return f.destroy(),this.each(function(){d.removeData(this,"jPages")}),this;"number"===b&&0===a%1&&f.validNewPage(a)&&f.paginate(a);return this}})(jQuery,window,document);